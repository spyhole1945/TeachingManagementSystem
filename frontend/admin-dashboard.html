<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®¡ç†å‘˜æ§åˆ¶å° - æ•™å­¦ç®¡ç†ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="css/styles.css">
    <style>
        .navbar {
            background: rgba(30, 41, 59, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(148, 163, 184, 0.1);
            padding: var(--spacing-md) 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .navbar-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .navbar-brand {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-primary);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .navbar-user {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--danger) 0%, #DC2626 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 1.125rem;
            color: white;
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
        }

        .dashboard-header {
            padding: var(--spacing-2xl) 0;
            border-bottom: 1px solid rgba(148, 163, 184, 0.1);
            margin-bottom: var(--spacing-2xl);
        }

        .tabs {
            display: flex;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-xl);
            border-bottom: 2px solid rgba(148, 163, 184, 0.1);
        }

        .tab {
            padding: var(--spacing-md) var(--spacing-lg);
            background: none;
            border: none;
            color: var(--text-muted);
            font-weight: 600;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            margin-bottom: -2px;
            transition: all var(--transition-base);
        }

        .tab.active {
            color: var(--primary-light);
            border-bottom-color: var(--primary-light);
        }

        .tab:hover:not(.active) {
            color: var(--text-secondary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }

        .empty-state {
            text-align: center;
            padding: var(--spacing-2xl);
            background: rgba(30, 41, 59, 0.3);
            border-radius: var(--radius-lg);
            border: 2px dashed rgba(148, 163, 184, 0.1);
        }

        .empty-state-icon {
            font-size: 3rem;
            margin-bottom: var(--spacing-md);
            opacity: 0.5;
        }
    </style>
</head>

<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="container navbar-content">
            <a href="#" class="navbar-brand">
                <span style="font-size: 1.5rem;">ğŸ“š</span>
                æ•™å­¦ç®¡ç†ç³»ç»Ÿ
                <span class="badge badge-danger">ç®¡ç†å‘˜</span>
            </a>
            <div class="navbar-user">
                <div class="text-right" style="line-height: 1.2;">
                    <div style="font-weight: 600;" id="adminName">Loading...</div>
                    <div style="font-size: 0.75rem; color: var(--text-muted);">System Admin</div>
                </div>
                <div class="user-avatar">AD</div>
                <button class="btn btn-secondary btn-sm" onclick="logout()">é€€å‡º</button>
            </div>
        </div>
    </nav>

    <div class="container">
        <!-- Header -->
        <header class="dashboard-header">
            <h1 style="font-size: 2rem; font-weight: 700; margin-bottom: var(--spacing-xs);">ç³»ç»Ÿæ¦‚è§ˆ</h1>
            <p class="text-muted" id="currentDate"></p>
        </header>

        <!-- Stats -->
        <div class="grid grid-cols-4 mb-3">
            <div class="stat-card" onclick="switchTab('users')" style="cursor: pointer;">
                <div class="stat-value" id="totalUsers">-</div>
                <div class="stat-label">æ€»ç”¨æˆ·</div>
            </div>
            <div class="stat-card" onclick="switchTab('courses')" style="cursor: pointer;">
                <div class="stat-value" id="totalCourses">-</div>
                <div class="stat-label">æ€»è¯¾ç¨‹</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="activeSessions">-</div>
                <div class="stat-label">æ´»è·ƒä¼šè¯</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="systemStatus" style="color: var(--secondary);">æ­£å¸¸</div>
                <div class="stat-label">ç³»ç»ŸçŠ¶æ€</div>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <div class="tabs">
            <button class="tab active" onclick="switchTab('overview')">ğŸ“Š æ¦‚è§ˆ</button>
            <button class="tab" onclick="switchTab('users')">ğŸ‘¥ ç”¨æˆ·ç®¡ç†</button>
            <button class="tab" onclick="switchTab('courses')">ğŸ“š è¯¾ç¨‹ç®¡ç†</button>
            <button class="tab" onclick="switchTab('settings')">âš™ï¸ ç³»ç»Ÿè®¾ç½®</button>
        </div>

        <!-- Tab Contents -->
        <div id="overviewTab" class="tab-content active">
            <div class="alert alert-info">
                <h3 style="font-size: 1.125rem; margin-bottom: var(--spacing-sm);">ğŸ“¢ æ¬¢è¿æ¥åˆ°ç®¡ç†å‘˜æ§åˆ¶å°</h3>
                <p>æ‚¨æ‹¥æœ‰ç³»ç»Ÿçš„æœ€é«˜æƒé™ï¼Œå¯ä»¥åœ¨è¿™é‡Œç®¡ç†ç”¨æˆ·ã€è¯¾ç¨‹å’Œç³»ç»Ÿè®¾ç½®ã€‚</p>
            </div>

            <div class="grid grid-cols-2">
                <div class="card">
                    <h3 class="card-title" style="font-size: 1.25rem;">ğŸ” å¿«é€Ÿæ“ä½œ</h3>
                    <div class="grid grid-cols-2 mt-2" style="gap: var(--spacing-md);">
                        <button class="btn btn-primary w-full">ğŸ‘¤ æ·»åŠ ç”¨æˆ·</button>
                        <button class="btn btn-secondary w-full">ğŸ“š å®¡æ ¸è¯¾ç¨‹</button>
                        <button class="btn btn-secondary w-full">ğŸ“¢ å‘å¸ƒé€šçŸ¥</button>
                        <button class="btn btn-secondary w-full">ğŸ’¾ å¤‡ä»½æ•°æ®</button>
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title" style="font-size: 1.25rem;">ğŸ“ ç³»ç»Ÿæ—¥å¿—</h3>
                    <ul
                        style="list-style: none; color: var(--text-muted); font-size: 0.875rem; margin-top: var(--spacing-md);">
                        <li style="margin-bottom: 8px;">â€¢ [2024-03-20 14:30] System backup completed</li>
                        <li style="margin-bottom: 8px;">â€¢ [2024-03-20 10:15] New course CS101 created</li>
                        <li style="margin-bottom: 8px;">â€¢ [2024-03-19 18:00] Daily maintenance finished</li>
                    </ul>
                </div>
            </div>
        </div>

        <div id="usersTab" class="tab-content">
            <div class="card">
                <div class="flex justify-between items-center mb-2">
                    <h3 class="card-title" style="margin-bottom: 0;">ç”¨æˆ·ç®¡ç†</h3>
                    <div class="flex gap-2">
                        <button class="btn btn-secondary" onclick="openImportModal('user')">ğŸ“¤ æ‰¹é‡å¯¼å…¥</button>
                        <button class="btn btn-primary" onclick="alert('Func not impl')">ğŸ‘¤ æ·»åŠ ç”¨æˆ·</button>
                    </div>
                </div>

                <div class="table-container">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>ç”¨æˆ·å</th>
                                <th>å§“å</th>
                                <th>è§’è‰²</th>
                                <th>çŠ¶æ€</th>
                                <th>æ³¨å†Œæ—¶é—´</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody id="userListBody">
                            <!-- Populated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div id="coursesTab" class="tab-content">
            <div class="card">
                <div class="flex justify-between items-center mb-2">
                    <h3 class="card-title" style="margin-bottom: 0;">è¯¾ç¨‹ç®¡ç†</h3>
                    <div class="flex gap-2">
                        <button class="btn btn-secondary" onclick="openImportModal('course')">ğŸ“¤ æ‰¹é‡å¯¼å…¥</button>
                        <button class="btn btn-primary" onclick="alert('Func not impl')">ğŸ“š å¼€è®¾è¯¾ç¨‹</button>
                    </div>
                </div>

                <div class="table-container">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>ä»£ç </th>
                                <th>åç§°</th>
                                <th>å­¦åˆ†</th>
                                <th>å­¦æœŸ</th>
                                <th>ä»»è¯¾æ•™å¸ˆ</th>
                                <th>çŠ¶æ€</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody id="courseListBody">
                            <!-- Populated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div id="settingsTab" class="tab-content">
            <div class="empty-state">
                <div class="empty-state-icon">âš™ï¸</div>
                <h3>ç³»ç»Ÿè®¾ç½®</h3>
                <p class="text-muted">åŠŸèƒ½å¼€å‘ä¸­...</p>
            </div>
        </div>
    </div>

    <!-- Edit User Modal -->
    <div id="editUserModal" class="modal"
        style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; justify-content: center; align-items: center;">
        <div class="modal-content"
            style="background: var(--bg-secondary); padding: 2rem; border-radius: var(--radius-lg); width: 100%; max-width: 500px; border: 1px solid rgba(148,163,184,0.2);">
            <div class="flex justify-between items-center mb-2">
                <h3 class="card-title">ç¼–è¾‘ç”¨æˆ·</h3>
                <button class="btn btn-secondary btn-sm" onclick="closeEditUserModal()">âœ•</button>
            </div>

            <form id="editUserForm" onsubmit="handleUpdateUser(event)">
                <input type="hidden" id="editUserId">

                <div class="form-group">
                    <label class="form-label">ç”¨æˆ·å</label>
                    <input type="text" id="editUsername" class="form-input" required>
                </div>

                <div class="form-group">
                    <label class="form-label">å§“å</label>
                    <input type="text" id="editFullName" class="form-input" required>
                </div>

                <div class="form-group">
                    <label class="form-label">é‚®ç®±</label>
                    <input type="email" id="editEmail" class="form-input" required>
                </div>

                <div class="grid grid-cols-2 gap-2">
                    <div class="form-group">
                        <label class="form-label">è§’è‰²</label>
                        <select id="editRole" class="form-input">
                            <option value="student">å­¦ç”Ÿ</option>
                            <option value="teacher">æ•™å¸ˆ</option>
                            <option value="admin">ç®¡ç†å‘˜</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">çŠ¶æ€</label>
                        <select id="editStatus" class="form-input">
                            <option value="true">æ­£å¸¸</option>
                            <option value="false">å†»ç»“</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">é‡ç½®å¯†ç  (ç•™ç©ºåˆ™ä¸ä¿®æ”¹)</label>
                    <input type="password" id="editPassword" class="form-input" placeholder="è¾“å…¥æ–°å¯†ç ">
                </div>

                <div id="editUserResult" class="hidden alert mt-2"></div>

                <div class="flex gap-2 justify-end" style="margin-top: 1.5rem;">
                    <button type="button" class="btn btn-secondary" onclick="closeEditUserModal()">å–æ¶ˆ</button>
                    <button type="submit" class="btn btn-primary">ä¿å­˜ä¿®æ”¹</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Batch Import Modal -->
    <div id="importModal" class="modal"
        style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; justify-content: center; align-items: center;">
        <div class="modal-content"
            style="background: var(--bg-secondary); padding: 2rem; border-radius: var(--radius-lg); width: 100%; max-width: 500px; border: 1px solid rgba(148,163,184,0.2);">
            <div class="flex justify-between items-center mb-2">
                <h3 class="card-title" id="importModalTitle">æ‰¹é‡å¯¼å…¥</h3>
                <button class="btn btn-secondary btn-sm" onclick="closeImportModal()">âœ•</button>
            </div>

            <p class="text-muted mb-2">è¯·å…ˆä¸‹è½½æ¨¡æ¿ï¼Œå¡«å†™åä¸Šä¼ Excelæ–‡ä»¶ã€‚</p>

            <div class="form-group">
                <button class="btn btn-secondary w-full" onclick="downloadTemplate()"
                    style="width: 100%; margin-bottom: 1rem;">
                    â¬‡ï¸ ä¸‹è½½Excelæ¨¡æ¿
                </button>
            </div>

            <div class="form-group">
                <label class="form-label">ä¸Šä¼ æ–‡ä»¶ (.xlsx)</label>
                <input type="file" id="importFile" accept=".xlsx" class="form-input">
            </div>

            <div id="importResult" class="hidden alert mt-2"></div>

            <div class="flex gap-2 justify-end" style="justify-content: flex-end; margin-top: 1rem;">
                <button class="btn btn-secondary" onclick="closeImportModal()">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="handleBatchImport()">å¼€å§‹å¯¼å…¥</button>
            </div>
        </div>

        <script src="js/api.js"></script>
        <script>
            // Check authentication
            if (!checkAuth() || !api.user || api.user.role !== 'admin') {
                window.location.href = 'login.html';
            }

            // Initialize
            document.getElementById('adminName').textContent = api.user.full_name;
            document.getElementById('currentDate').textContent = new Date().toLocaleDateString('zh-CN', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                weekday: 'long'
            });

            // Load stats
            async function loadStats() {
                try {
                    // Placeholder stats
                    document.getElementById('totalUsers').textContent = '24'; // Updated based on seed
                    document.getElementById('totalCourses').textContent = '3';
                    document.getElementById('activeSessions').textContent = '12';
                } catch (e) {
                    console.error("Failed to load stats", e);
                }
            }

            loadStats();

            // Switch tabs
            function switchTab(tabName) {
                // Update buttons
                document.querySelectorAll('.tab').forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.getAttribute('onclick').includes(tabName)) {
                        btn.classList.add('active');
                    }
                });

                // Update content
                document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
                document.getElementById(tabName + 'Tab').classList.add('active');

                // Load data if needed
                if (tabName === 'users') loadUsers();
                if (tabName === 'courses') loadCourses();
            }

            // --- User Management ---
            async function loadUsers() {
                const tbody = document.getElementById('userListBody');
                tbody.innerHTML = '<tr><td colspan="7" class="text-center">åŠ è½½ä¸­...</td></tr>';

                try {
                    const users = await api.request('/admin/users');
                    tbody.innerHTML = '';

                    users.forEach(user => {
                        const row = document.createElement('tr');
                        const badges = {
                            'admin': 'badge-danger',
                            'teacher': 'badge-info',
                            'student': 'badge-success'
                        };
                        const roleBadge = `<span class="badge ${badges[user.role] || 'badge-secondary'}">${user.role}</span>`;
                        const statusBadge = user.is_active
                            ? '<span class="badge badge-success">æ­£å¸¸</span>'
                            : '<span class="badge badge-danger">å†»ç»“</span>';

                        row.innerHTML = `
                        <td>${user.id}</td>
                        <td style="font-weight: 500; color: var(--text-primary);">${user.username}</td>
                        <td>${user.full_name}</td>
                        <td>${roleBadge}</td>
                        <td>${statusBadge}</td>
                        <td style="color: var(--text-muted); font-size: 0.85rem;">${new Date(user.created_at).toLocaleDateString()}</td>
                        <td>
                            <button class="btn btn-secondary btn-sm" onclick="openEditUserModal(${user.id}, '${user.username}', '${user.email}', '${user.full_name}', '${user.role}', ${user.is_active})">ç¼–è¾‘</button>
                        </td>
                    `;
                        tbody.appendChild(row);
                    });
                } catch (error) {
                    tbody.innerHTML = `<tr><td colspan="7" class="text-center text-danger">åŠ è½½å¤±è´¥: ${error.message}</td></tr>`;
                }
            }

            // --- Edit User Logic ---
            function openEditUserModal(id, username, email, fullName, role, isActive) {
                document.getElementById('editUserId').value = id;
                document.getElementById('editUsername').value = username;
                document.getElementById('editEmail').value = email;
                document.getElementById('editFullName').value = fullName;
                document.getElementById('editRole').value = role;
                document.getElementById('editStatus').value = isActive.toString();
                document.getElementById('editPassword').value = ''; // Clear password field

                document.getElementById('editUserResult').classList.add('hidden');
                document.getElementById('editUserModal').style.display = 'flex';
            }

            function closeEditUserModal() {
                document.getElementById('editUserModal').style.display = 'none';
            }

            async function handleUpdateUser(event) {
                event.preventDefault();

                const userId = document.getElementById('editUserId').value;
                const resultDiv = document.getElementById('editUserResult');
                resultDiv.className = 'alert alert-info mt-2';
                resultDiv.textContent = 'ä¿å­˜ä¸­...';
                resultDiv.classList.remove('hidden');

                const updates = {
                    username: document.getElementById('editUsername').value,
                    full_name: document.getElementById('editFullName').value,
                    email: document.getElementById('editEmail').value,
                    role: document.getElementById('editRole').value,
                    is_active: document.getElementById('editStatus').value === 'true'
                };

                const password = document.getElementById('editPassword').value;
                if (password) {
                    updates.password = password;
                }

                try {
                    const token = localStorage.getItem('tms_token');
                    const response = await fetch(`${API_BASE_URL}/admin/users/${userId}`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${token}`
                        },
                        body: JSON.stringify(updates)
                    });

                    const data = await response.json();

                    if (!response.ok) throw new Error(data.detail || 'æ›´æ–°å¤±è´¥');

                    resultDiv.className = 'alert alert-success mt-2';
                    resultDiv.textContent = 'æ›´æ–°æˆåŠŸï¼';

                    // Refresh and close
                    setTimeout(() => {
                        closeEditUserModal();
                        loadUsers();
                    }, 1000);

                } catch (error) {
                    resultDiv.className = 'alert alert-error mt-2';
                    resultDiv.textContent = 'é”™è¯¯: ' + error.message;
                }
            }

            // --- Course Management ---
            async function loadCourses() {
                const tbody = document.getElementById('courseListBody');
                tbody.innerHTML = '<tr><td colspan="7" class="text-center">åŠ è½½ä¸­...</td></tr>';

                try {
                    const courses = await api.request('/admin/courses');
                    tbody.innerHTML = '';

                    courses.forEach(course => {
                        const row = document.createElement('tr');
                        const statusBadge = course.is_active
                            ? '<span class="badge badge-success">è¿›è¡Œä¸­</span>'
                            : '<span class="badge badge-secondary">å·²ç»“è¯¾</span>';

                        row.innerHTML = `
                        <td style="font-weight: 600; color: var(--primary-light);">${course.code}</td>
                        <td style="font-weight: 500; color: var(--text-primary);">${course.name}</td>
                        <td>${course.credits}</td>
                        <td>${course.semester}</td>
                        <td>${course.teacher}</td>
                        <td>${statusBadge}</td>
                        <td>
                            <button class="btn btn-secondary btn-sm">è¯¦æƒ…</button>
                        </td>
                    `;
                        tbody.appendChild(row);
                    });
                } catch (error) {
                    tbody.innerHTML = `<tr><td colspan="7" class="text-center text-danger">åŠ è½½å¤±è´¥: ${error.message}</td></tr>`;
                }
            }

            // --- Batch Import Logic ---
            let currentImportType = null; // 'user' or 'course'

            function openImportModal(type) {
                currentImportType = type;
                const title = type === 'user' ? 'æ‰¹é‡å¯¼å…¥ç”¨æˆ·' : 'æ‰¹é‡å¯¼å…¥è¯¾ç¨‹';
                document.getElementById('importModalTitle').textContent = title;
                document.getElementById('importFile').value = '';
                document.getElementById('importResult').classList.add('hidden');

                document.getElementById('importModal').style.display = 'flex';
            }

            function closeImportModal() {
                document.getElementById('importModal').style.display = 'none';
            }

            async function downloadTemplate() {
                if (!currentImportType) return;
                const endpoint = currentImportType === 'user' ? '/admin/users/template' : '/admin/courses/template';

                try {
                    // Use a direct temporary link approach or api.js if it supports blob
                    const token = localStorage.getItem('tms_token');
                    if (!token) throw new Error('Not logged in');

                    const response = await fetch(`${API_BASE_URL}${endpoint}`, {
                        headers: { 'Authorization': `Bearer ${token}` }
                    });

                    if (!response.ok) throw new Error('Download failed');

                    const blob = await response.blob();
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `${currentImportType}_template.xlsx`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    window.URL.revokeObjectURL(url);

                } catch (error) {
                    alert('æ¨¡æ¿ä¸‹è½½å¤±è´¥: ' + error.message);
                }
            }

            async function handleBatchImport() {
                const fileInput = document.getElementById('importFile');
                const file = fileInput.files[0];
                if (!file) {
                    alert('è¯·å…ˆé€‰æ‹©æ–‡ä»¶');
                    return;
                }

                const resultDiv = document.getElementById('importResult');
                resultDiv.classList.remove('hidden', 'alert-success', 'alert-error');
                resultDiv.className = 'alert alert-info mt-2';
                resultDiv.textContent = 'æ­£åœ¨å¯¼å…¥...';

                const endpoint = currentImportType === 'user' ? '/admin/users/batch' : '/admin/courses/batch';
                const formData = new FormData();
                formData.append('file', file);

                try {
                    const token = localStorage.getItem('tms_token');
                    const response = await fetch(`${API_BASE_URL}${endpoint}`, {
                        method: 'POST',
                        headers: { 'Authorization': `Bearer ${token}` }, // Do NOT set Content-Type, browser does it
                        body: formData
                    });

                    const data = await response.json();

                    if (!response.ok) throw new Error(data.detail || 'å¯¼å…¥å¤±è´¥');

                    // Show result
                    resultDiv.innerHTML = `
                    <strong>å¯¼å…¥å®Œæˆ!</strong><br>
                    æˆåŠŸ: ${data.success}<br>
                    å¤±è´¥: ${data.failed}
                    ${data.errors.length > 0 ? '<br><small>' + data.errors.slice(0, 3).join('<br>') + (data.errors.length > 3 ? '...' : '') + '</small>' : ''}
                `;

                    if (data.failed === 0) {
                        resultDiv.classList.add('alert-success');
                        resultDiv.classList.remove('alert-info');
                        // Refresh table
                        if (currentImportType === 'user') loadUsers();
                        else loadCourses();

                        // Close modal after delay
                        setTimeout(() => {
                            if (document.getElementById('importModal').style.display !== 'none') {
                                // Keep open if user wants to see result, or close? User might want to see errors.
                                // Let's just alert simple success if 100% success
                            }
                        }, 2000);
                    } else {
                        resultDiv.classList.add('alert-error');
                        resultDiv.classList.remove('alert-info');
                    }

                } catch (error) {
                    resultDiv.className = 'alert alert-error mt-2';
                    resultDiv.textContent = 'é”™è¯¯: ' + error.message;
                }
            }

            function logout() {
                if (confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ')) {
                    api.logout();
                    window.location.href = 'login.html';
                }
            }
        </script>
</body>

</html>